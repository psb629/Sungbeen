# Servise Port

## 서비스 포트란...

개인적인 생각으로\
서비스 포트란 하나의 컴퓨터에서 S/W등을 구동하고 있을 때 구분하기 쉽게 하도록 지정해놓은 꼬리표라고 생각하시면됩니다.\
예를 들어 제 컴퓨터에서 A라는 서비스를 구동하고 있습니다.\
하나의 컴퓨터에서 A라는 서비스 하나만 사용할때에는 문제가 되지 않지만 현대의 컴퓨터에서는 그러지 않겠죠.

제 컴퓨터의 IP는 192.168.1.100이라고 할 때 A라는 서비스에 접속을 할때에는 특별한 문제는 없지만  B라는 서비스를 같이 사용할 때 IP만 사용하여서는 어떤 서비스를 사용할 것인지 구분할 수 없습니다.

그렇기 때문에 A라는 서비스에 1번이라는 번호를 부여하고 B라는 서비스에 100이라는 번호를 부여해 봅니다. 이게 "서비스 포트"라는 개념이죠. 서비스 포트를 입력할때에는 "IP주소:서비스포트 숫자" 라는 방식을 사용합니다.

그렇게 되면 제가 A라는 서비스를 이용하고 싶을때에는 192.168.1.100:1이라고 쓰면 A라는 서비스를 지칭하는 것이고 192.168.1.100:100이라고 쓰면 B라는 서비스를 지칭하는것을 구분할 수 있습니다.

이제 A와 B에 대한 서비스를 구분할 수 있겠네요.
생략해서 포트번호라고도 합니다. 다른사람들과 서비스포트에 대한 이야기를 나눌때 "XX접속하는 포트번호가 뭐야??" 라는 식의 대화로도 가능하겠네요

## 기본 서비스 포트

이처럼 여러 서비스를 구분하기 위해 번호를 지정하여 구분하도록 만든것이 서비스 포트입니다.

그중에서도 예약, 지정된 포트들이 있는데요 그중 유명한 port들은 아래 링크에 기재되어 있습니다.\
[TCP/UDP의 포트목록(위키백과)](https://ko.wikipedia.org/wiki/TCP/UDP%EC%9D%98_%ED%8F%AC%ED%8A%B8_%EB%AA%A9%EB%A1%9D)

기본적으로 ssh를 설정하게되면 22번포트로 설정되어있고 http를 구성하게되면 80포트로 설정됩니다.
기본설정으로 들어가있거든요

이 포트번호들은 수정할수없는 번호가 아닌 권고값들입니다. 개인 또는 단체의 사용 용도에 따라 설정을 통해 포트번호를 변경할 수 있다는 뜻입니다.

## 특별한 포트번호

80포트라는 포트번호가있습니다 위에서 설명드렸다시피 http를 사용할때 기본적으로 적용되어있는 포트라고 설명드렸는데요 이 80포트는 특별합니다. 생략이 되는 포트번호거든요 시작하기전 란에 모든사람들이 사용한다는 말이 이부분 입니다. google에 접속하기 위해서는 정확한 주소는 http://www.google.com:80 입니다. 하지만 80은 생략이 가능하므로 http://www.google.com 이라고만 입력하여도 접속이 가능하다는 거죠.

대부분의 포털사이트들은 80포트를 사용합니다. 일반사용자들의 편의를 위해 :포트번호를 쓰지않아도 되도록 말이죠

# Port Forwarding

## 포트포워딩의 필요성

내부네트워크 또는 네트워크에 연결되지 않은 하나의 호스트만 사용하는 서비스들이라면 필요가 없는 기능입니다.\
그러나 자주거론되는 이유는 과거와 다르게 IT의발달로 인하여 외부에서 제공하는 서비스등을 제공 받거나 제공해주기 위하여 개발되었기 때문이죠.\
또 공유기에 하나의 호스트만 붙어있질 않습니다.\
스마트폰을 이용하여 무선공유기에 접속을 하여도 호스트가 되는거죠.\
그리고 내부 IP는 특별한 작업을 거치지 않는 한 외부에서 접속할 수 없습니다. 오로지 외부IP를 통해서만 접속이 가능하죠.\
제 공유기에 연결된 호스트가 3개라고 가정을 할때 3개모두 ssh를 작동중입니다.(3개 모두 ssh는 기본값인 22포트)

	* A Host(192.168.1.100)
	* B Host(192.168.1.101)
	* C Host(192.168.1.102)
	* my clmnlab macbookair(192.168.219.124)

이때 공유기에 연결된 호스트들의 내부IP들은 각각 위와 같습니다.

이중 C호스트에서 A라는 호스트의 ssh접속을 하고자한다면 어떻게해야 할까요?\
서비스포트의 개념을 알기 때문에\
192.168.1.100:22라고 입력을 한다면 A라는 호스트에 22포트로 접속을 한다는것을 알 수 있겠죠.

하지만 외부에서 접속을 할때에는 달라집니다.\
서비스포트를 이용하여 외부에서도 접속을 가능하도록 해야하는데 여기서 문제가 생깁니다.

위에서 말했듯이 외부에서 A호스트를 ssh로 접속하고자할때 내부IP인 192.168.1.100를 볼 수 없거든요.\
내 공유기의 공인(외부)IP가 211.123.123.123이라고 할때(내 경우 유동IP 112.155.247.222), 211.123.123.123:22를 입력해도 A호스트의 ssh로 접속할 수 없습니다.\
저 IP주소가 공유기를 지칭하는지 A호스트를 말하는지 B인지 그마저도 아니면 C호스트를 말하는건지 알 수 없거든요.

이를 해결하기 위해 나온게 포트포워딩이라는 것입니다.

## 포트포워딩의 기능

외부에서 A호스트의 ssh로 접속하고 싶다.

이럴땐 공유기에서 구분하면 됩니다.\
"외부에서 특정 포트번호로 들어오게 된다면 A호스트의 22번 포트를 지칭하는것이다" 라는 규칙을 설정하면 됩니다.

공유기의 공인IP 뒤에 서비스포트번호처럼 특정 포트번호를 입력하면 지정한 내부 호스트의 특정포트로 보내버리는거죠.\
포트포워딩 설정 시 1000-1010포트로 들어오는 것들을 A호스트의 22포트로 보내라 라는 규칙을 설정하면 아래와 같이 생각하시면됩니다.

	설정한 포트 범위(1000-1010) => 포트포워딩 => 설정한 호스트의 포트번호(192.168.1.100:22)

공유기의 공인IP가 211.123.123.123이므로 211.123.123.123:1000 또는 1000~1010까지의 숫자를 입력하면 C호스트가 192.168.1.100:22라는 주소를 입력한 것과 동일하게 접속이 가능하게 됩니다.(내 경우 port 7001을 clmnlab macbookair에 연결해줌.)

	서비스포트: 7001-7001
	프로토콜: TCP
	IP주소/내부포트: 192.168.219.124
	포트: 22

이처럼 외부에서 접속 시 어떤 호스트의 어떤 서비스포트에 연결을 해주는지 설정을 해주는 것을 포트포워딩이라 합니다.

## 결론

포트포워딩의 필요성 때에 왜 포트포워딩이 필요한가에 대해서도 작성 했지만 또다른 생각을 할 수가 있습니다.

"그럼 그냥 A호스트, B호스트, C호스트의 SSH포트를 다르게 주면안돼?"

답이 될 수 있습니다. 하지만 이것은 내부에서 사용할때 포트번호를 바꿔 주는 것이지 외부에서는 알 수가 없죠\
결국에는 들어오는 경로가 있으면 목적지 경로도 설정을 해줘야하니 포트번호가 바뀌면 포트포워딩 설정을 다시 해야됩니다.

그리고 된다고 하더라도 각각의 호스트마다 접속을 해서 포트번호를 바꾸기에는 여간 귀찮은 일이 아닙니다.

그럴바엔 관리가 가능한 공유기에서 특정호스트들의 외부포트번호를 설정해주기만 하면 되거든요.

위처럼 특정 호스트의 IP와 서비스포트로 전달해 주기위해 필요한 기능이 포트 포워딩이라는 기능입니다.

# DNS와 DDNS란

## 들어가며

DNS라는 말을 자주들어보셧나요?

DNS란 Domain Name System의 약자 이며 우리가 인터넷을 편리하게 쓸수있게 만들어 주는 것입니다.

기존의 인터넷의 사이트들은 모두 IP주소로 되어있습니다.

google.com의 IP주소는 216.58.197.238입니다.(현재 제 PC기준)

naver.com의 IP주소는 202.179.177.21입니다.(4개까지 확인되네요)

만약 제가 google이나 naver만 사용한다면 저 두개의 IP주소만 외우면되겠죠

그러나 IP주소를 외우기에는 숫자가 많아 헷갈리고 또 저 두개의 사이트만 들어가지 않습니다.

daum.net도 접속하고 amazon.com에도 접속할 때도 있습니다.

그럼 제가 접속할 사이트의 IP주소를 모두 외워야 될까요?

물론 IP주소를 외워서 사용하는 엄청난 사용자들도 있지만

대다수의 사용자들은 IP주소를 외우기가 쉽지 않습니다.

## DNS의 기능

그래서 개발된 게 DNS인데요

DNS는 저희가 익히 알고있는 google.com, naver.com 과 같은 도메인이름과 IP주소를 서로 변환 하는 역활을 합니다.

사용자가 google.com이라는 주소를 브라우저 주소창에 입력을 하면 저희 눈에는 보이지 않지만\
자동으로 216.58.197.238으로 접속을 하는거죠

DNS서버라는게 있는데 이런 도메인이름과 그에 맞는 IP주소 정를 가지고 있는 서버를 말합니다.

google.com이라고 브라우저 주소창에 입력을 했을때

DNS서버에 google.com이 무엇인지 물어보고(질의)\
DNS서버에 google.com에 대한 IP주소가 있을때 그에 맞는\
IP주소를 알려주는(응답)기능을 하게됩니다.

## DDNS란

DNS가 편리하다는것을 알았습니다.\
그럼 DDNS가 무엇이냐\
DDNS란 Dynamic DNS 또는 동적 DNS라고 쓰이며 실시간으로 DNS를 갱신하는 방법입니다.

일반적으로 이용하는 포털사이트, 기업, 기관의 홈페이지들은 기관 또는 기업에서 소유하고있는 고정IP를 통해서 DNS주소를 할당 받습니다.\
하지만 가정 또는 개인 단위에서 고정IP를 할당 받기 위해서는 많은 비용이 들고\
기관, 기업에서 사용하는것과 같은 보안 시스템등이 없기 때문에 IP추적 또는 사생활 침해에 노출될 수 있습니다.

만약 유동IP에 DNS주소를 할당하면 IP가 변경되기 전까지는 정상적으로 작동하지만 IP가 바뀌고 기존 IP주소를 다른 사용자가 할당받는다면\
엉뚱한 사람에게 트래픽이 가게됩니다.

이를 해결하기 위해 나온 기술이 DDNS이며 IP주소가 변경되게되면 DNS에 IP를 바뀐 IP주소로 갱신해 주기때문에

IP주소가 변경되더라도 편리하게 사용이 가능합니다.

## 결론

DNS란 외우기 힘든 IP주소를 도메인형식으로 사용할 수 있도록 해주는 기능이라는 것을 알았고\
DDNS란 유동IP를 위해 IP가 변경되었을 때 자동으로 DNS서버의 IP를 갱신해주는 기능이라는 것을 알아보았습니다.

출처: [취미로하자](https://wooooon.tistory.com/category/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC/Router)
